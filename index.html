<!DOCTYPE html>

<html>

<head>
    <meta charset="UTF-8">
    <title>OrgChart</title>
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>

    <div class=action-buttons>
        <button onclick='chart.setExpanded("O-6164",true)'>Expand O-6164</button>
        <button onclick='chart.setExpanded("O-6164",false)'>Collapse O-6164</button>
        <button onclick='chart.addNode({id:"root child",parentId:"O-6066"})'>Add node as roots' child</button>
        <button onclick='chart.addNode({id:"5-th level node",parentId:"O-6164",expanded:true})'>Insert node at 5-th level</button>
        <button onclick='chart.removeNode("O-6070")'>Remove O-6070</button>
    </div>


    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="./build/d3-org-chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3-flextree@2.0.0/build/d3-flextree.js"></script>



    <a href="https://github.com/bumbeishvili/d3-organization-chart">
        <img style="position:fixed;top:0;right:0;border:0;z-index:2;" width="149" height="149"
            src="https://bumbeishvili.github.io/d3-tooltip/forkme.png" alt="Fork me on GitHub">
    </a>

    <div class="chart-container" style=" padding-top:10px;  height:1200px "> </div>

    <script>
        var chart;
        d3.csv('data.csv')
            .then(dataFlattened => {
                chart = new d3.OrgChart()
                    .container('.chart-container')
                    .data(dataFlattened)
                    // .svgHeight(window.innerHeight)
                    // .initialZoom(1)
                    // .nodeWidth((d3Node) => {
                    //     let i = 0;
                    //     if (d3Node.parent) { i = d3Node.parent.children.indexOf(d3Node); }
                    //     return (!i || i == d3Node.parent.children.length - 1) ? 200 : 100
                    // })
                    // .nodeHeight((d3Node) => {
                    //     let i = 0;
                    //     if (d3Node.parent) { i = d3Node.parent.children.indexOf(d3Node); }
                    //     return (!i || i == d3Node.parent.children.length - 1) ? 200 : 100
                    // })
                    // .siblingsMargin(d3Node => 0)
                    // .childrenMargin(d3Node => 60)
                    // .onNodeClick(d => console.log(d + ' node clicked'))
                    // .linkUpdate(function (d3Node, i, arr) {
                    //     const link = this;
                    //     d3.select(link)
                    //         .attr('stroke-dasharray', !i ? '2 2' : 'none')
                    //         .attr('stroke-width', 3)
                    // })
                    // .nodeUpdate(function (data, i, arr) {
                    //     d3.select(this).on('click.node', (event, d, i) => {
                    //         console.log(d.nodeId + ' node clicked')
                    //     })
                    // })
                    // .nodeContent(function (d, i, arr) {
                    //     console.log(d)
                    //     return `
                    //        <div style="padding:0px">
                    //          <img src="${d.data.imageUrl}"  style="border-radius:100px;width:60px;height:60px;" />
                    //          Children Direct:${d.data._directSubordinates}
                    //          Children Total:${d.data._totalSubordinates}
                    //         </div>
                    //     `;
                    // })
                    .render()
            })
    </script>

</body>