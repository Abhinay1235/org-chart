<!DOCTYPE html>

<html>

<head>
    <meta charset="UTF-8">
    <title>OrgChart</title>
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>

    <!----------------   ORG CHART NON ESSENTIAL CONTENT ------------>
    <link href="https://cdn.jsdelivr.net/npm/simptip@1.0.4/simptip.min.css" rel="stylesheet">
    <style>
        [data-tooltip]:focus:after {
            display: none;
            border-bottom-color: none !important;
            ;
        }

        [data-tooltip]:focus:before {
            display: none;
            border-bottom-color: none !important;
            ;
        }
    </style>

    <div class="action-buttons" style="margin:0 100px">


        <button onclick='chart.setExpanded("O-6164").render()' class="simptip-position-bottom"
            data-tooltip='chart.setExpanded("O-6164").render()'>Expand O-6164</button>
        <button onclick='chart.setExpanded("O-6164",false).render()' class="simptip-position-bottom"
            data-tooltip='chart.setExpanded("O-6164",false).render()'>Collapse O-6164</button>
        <button onclick='chart.addNode({id:"root child",parentId:"O-6066"})' class="simptip-position-bottom"
            data-tooltip='chart.addNode({id:"root child",parentId:"O-6066"})'>Add node as roots' child</button>
        <button onclick='chart.addNode({id:"5-th level node",parentId:"O-6164",_centered:true})'
            class="simptip-position-bottom"
            data-tooltip='chart.addNode({id:"5-th level node",parentId:"O-6164",_centered:true})'>Insert node at 5-th
            level</button>
        <button onclick='chart.removeNode("O-6067")' class="simptip-position-bottom"
            data-tooltip='chart.removeNode("O-6067")'>Remove O-6067</button>
        <button onclick='chart.layout(["right","bottom","left","top"][index++%4]).render()'
            class="simptip-position-bottom"
            data-tooltip='chart.layout(["right","bottom","left","top"][index++%4]).render()'>Swap Layouts
        </button>
        <button onclick='chart.fit()' class="simptip-position-bottom" data-tooltip='chart.fit()'>Fit
        </button>
        <button onclick='chart.setCentered("O-6162").render()' class="simptip-position-bottom"
            data-tooltip='chart.setCentered("O-6162").render()'>Center O-6162 </button>
        <button onclick='chart.setHighlighted("O-6162").render()' class="simptip-position-bottom"
            data-tooltip='chart.setHighlighted("O-6162").render()'>Highlight O-6162 </button>
        <button onclick='chart.setUpToTheRootHighlighted("O-6162").render()' class="simptip-position-bottom"
            data-tooltip='chart.setUpToTheRootHighlighted("O-6162").render()'>Highlight O-6162 to root </button>
        <button onclick='chart.clearHighlighting()' class="simptip-position-bottom"
            data-tooltip='chart.clearHighlighting().render()'>Clear highlighting </button>


    </div>

    <a href="https://github.com/bumbeishvili/d3-organization-chart">
        <img style="position:fixed;top:0;right:0;border:0;z-index:2;" width="149" height="149"
            src="https://bumbeishvili.github.io/d3-tooltip/forkme.png" alt="Fork me on GitHub">
    </a>

    <!----------------  ORG CHART ESSENTIAL CONTENT ---------------->

    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="./build/d3-org-chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3-flextree@2.0.0/build/d3-flextree.js"></script>
    <div class="chart-container" style=" padding-top:10px;  height:1200px ;background-color:white"> </div>

    <script>
        var index = 0;
        var chart;
        d3.csv('data.csv')
            .then(dataFlattened => {
                chart = new d3.OrgChart()
                    .container('.chart-container')
                    .data(dataFlattened)
                    // .svgHeight(window.innerHeight)
                    // .initialZoom(1)
                    // .nodeWidth((d3Node) => {
                    //     let i = 0;
                    //     if (d3Node.parent) { i = d3Node.parent.children.indexOf(d3Node); }
                    //     return (!i || i == d3Node.parent.children.length - 1) ? 200 : 100
                    // })
                    // .nodeHeight((d3Node) => {
                    //     let i = 0;
                    //     if (d3Node.parent) { i = d3Node.parent.children.indexOf(d3Node); }
                    //     return (!i || i == d3Node.parent.children.length - 1) ? 200 : 100
                    // })
                    // .siblingsMargin(d3Node => 0)
                    // .childrenMargin(d3Node => 60)
                    // .neightbourMargin((n1, n2) => 60)
                    // .onNodeClick(d => console.log(d + ' node clicked'))
                    // .linkUpdate(function (d3Node, i, arr) {
                    //     const link = this;
                    //     d3.select(link)
                    //         .attr('stroke-dasharray', !i ? '2 2' : 'none')
                    //         .attr('stroke-width', 3)
                    // })
                    // .nodeUpdate(function (data, i, arr) {
                    //     d3.select(this).on('click.node', (event, d, i) => {
                    //         console.log(d.nodeId + ' node clicked')
                    //     })
                    // })
                    // .nodeContent(function (d, i, arr) {
                    //     console.log(d)
                    //     return `
                    //        <div style="padding:0px">
                    //          <img src="${d.data.imageUrl}"  style="border-radius:100px;width:60px;height:60px;" />
                    //          Children Direct:${d.data._directSubordinates}
                    //          Children Total:${d.data._totalSubordinates}
                    //         </div>
                    //     `;
                    // })
                    .render()
            })
    </script>

</body>